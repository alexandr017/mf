# Функции профиля игрока

## Общая информация

Профиль игрока содержит информацию о статистике, командах, достижениях и настройках.

---

## 1. Основная информация

### Аватар и имя
- Аватар игрока (загружается в настройках)
- Имя и никнейм
- Рейтинг

### Родной город
- Поле `hometown_city_id` - связь с таблицей `cities`
- Поле `show_hometown` - чекбокс для отображения в профиле
- Отображается рядом с аватаром и никнеймом (если включено)
- Формат: "Родом из [Название города]"

### Текущая команда
- Показывается команда игрока в текущем сезоне
- Формат: "В настоящее время играет за [Название команды]"
- Ссылка ведет на страницу команды
- Если команды нет - не отображается

---

## 2. Статистика

### Общая статистика
- Голы
- Ассисты
- Рейтинг
- Сыграно матчей

### Карьера по сезонам
- История всех сезонов, в которых игрок состоял в командах
- Для каждого сезона:
  - Команда
  - Год сезона
  - Голы
  - Ассисты
  - Матчи

### Персональная статистика по годам

#### Вкладка "Статистика"
- Статистика по сезонам (из `user_teams`)
- Группировка по годам
- Показывает голы, ассисты, матчи за каждый сезон

#### Вкладка "Товарищеские игры"
- Статистика из товарищеских матчей
- Группировка по годам
- Показывает:
  - Голы из товарищеских матчей
  - Ассисты из товарищеских матчей
  - Количество матчей

#### Вкладка "Титулы"
- Достижения игрока
- Чемпионства
- Индивидуальные награды

---

## 3. Страница "Мои матчи"

### Расположение
- Доступна из меню аккаунта: `/account/matches`

### Функционал
- Показывает все матчи команды игрока:
  - Товарищеские матчи
  - Турнирные матчи
- Метки типов матчей:
  - "Товарищеская" (синяя метка)
  - Название турнира (основной цвет)

### Вкладки
1. **Прошедшие** - все матчи позднее вчера (от менее давних к более давним)
2. **Вчера, сегодня, завтра** - матчи за эти дни
3. **Будущие** - матчи начиная с послезавтра (от более поздних к менее поздним)

### Особенности
- Если у пользователя нет команды - показывается сообщение с предложением присоединиться
- При использовании фильтров вкладки скрываются
- Карточки матчей кликабельны (для товарищеских матчей)

---

## 4. Настройки профиля

### Основные данные
- Имя
- Никнейм
- Email
- Пароль
- Предпочитаемая позиция

### Родной город
- Выбор города из списка (select dropdown)
- Чекбокс "Показывать родной город в профиле"
- Сохраняется в `hometown_city_id` и `show_hometown`

### Аватар
- Загрузка изображения
- Максимальный размер: 5MB
- Поддерживаемые форматы: JPEG, PNG, JPG, GIF, WEBP

---

## 5. Административная панель

### CRUD пользователей
- Создание/редактирование пользователей
- Поля для родного города:
  - `hometown_city_id` - выбор города (select2)
  - `show_hometown` - чекбокс
- Все поля доступны для редактирования

---

## Технические детали

### Миграция
- `2025_12_20_000002_add_hometown_to_users_table.php`
- Добавляет поля `hometown_city_id` и `show_hometown`

### Модель User
- Связь `hometownCity()` - belongsTo City
- Поля в `$fillable`: `hometown_city_id`, `show_hometown`
- Cast: `show_hometown` => 'boolean'

### Контроллеры
- `AccountController@index` - получение статистики товарищеских игр
- `AccountController@matches` - страница "Мои матчи"
- `PlayersController@player` - профиль игрока с статистикой
- `AccountController@saveOptions` - сохранение настроек профиля

