<?php

namespace Database\Seeders;

use App\Models\Cities\City;
use App\Models\Countries\Country;
use App\Models\Teams\Team;
use Illuminate\Database\Seeder;
use Illuminate\Support\Str;

class TeamsSeeder extends Seeder
{
    /**
     * Run the database seeds.
     */
    public function run(): void
    {
        // Получаем страны и города
        $countries = Country::all();
        $cities = City::all();

        if ($countries->isEmpty() || $cities->isEmpty()) {
            $this->command->warn('Страны или города не найдены. Сначала запустите сидеры для стран и городов.');
            return;
        }

        // Разнообразные названия футбольных команд
        $teamNames = [
            'Реал Мадрид', 'Барселона', 'Манчестер Юнайтед', 'Ливерпуль', 'Челси',
            'Арсенал', 'Манчестер Сити', 'Бавария', 'Боруссия Дортмунд', 'Ювентус',
            'Милан', 'Интер', 'ПСЖ', 'Олимпик Лион', 'Атлетико Мадрид',
            'Валенсия', 'Севилья', 'Наполи', 'Рома', 'Лацио',
            'Тоттенхэм', 'Эвертон', 'Ньюкасл', 'Астон Вилла', 'Лестер Сити',
            'Боруссия Мёнхенгладбах', 'Байер Леверкузен', 'Шальке 04', 'Вольфсбург', 'Айнтрахт Франкфурт',
            'Порту', 'Бенфика', 'Спортинг', 'Аякс', 'ПСВ',
            'Фейеноорд', 'ЦСКА Москва', 'Зенит', 'Спартак Москва', 'Локомотив',
            'Динамо Киев', 'Шахтер Донецк', 'Галатасарай', 'Фенербахче', 'Бешикташ',
            'Селтик', 'Рейнджерс', 'Абердин', 'Хартс', 'Хиберниан',
            'Бока Хуниорс', 'Ривер Плейт', 'Фламенго', 'Палмейрас', 'Сантос',
            'Индепендьенте', 'Расинг', 'Эстудиантес', 'Велес Сарсфилд', 'Ньюэллс Олд Бойз'
        ];

        $stadiumNames = [
            'Сантьяго Бернабеу', 'Камп Ноу', 'Олд Траффорд', 'Энфилд', 'Стэмфорд Бридж',
            'Эмирейтс', 'Этихад', 'Альянц Арена', 'Сигнал Идуна Парк', 'Альянц Стадиум',
            'Сан-Сиро', 'Джузеппе Меацца', 'Парк де Пренс', 'Олимпик Лионне', 'Ванда Метрополитано',
            'Месталья', 'Рамон Санчес-Писхуан', 'Диего Армандо Марадона', 'Олимпико', 'Стадио Олимпико',
            'Тоттенхэм Хотспур Стэдиум', 'Гудисон Парк', 'Сент-Джеймс Парк', 'Вилла Парк', 'Кинг Пауэр Стэдиум',
            'Борussia-Парк', 'БайАрена', 'Фельтинс-Арена', 'Фольксваген Арена', 'Коммерцбанк-Арена',
            'Эштадиу ду Драгау', 'Эштадиу да Луж', 'Жозе Алваладе', 'Йохан Кройф Арена', 'Филипс Стэдион',
            'Де Кейп', 'ВЭБ Арена', 'Газпром Арена', 'Открытие Арена', 'РЖД Арена',
            'Олимпийский', 'Донбасс Арена', 'Тюрк Телеком Арена', 'Улкер Спортс Арена', 'Водафон Парк',
            'Селтик Парк', 'Айброкс', 'Питтодри', 'Тайнкасл', 'Истер Роуд'
        ];

        $this->command->info('Создание команд...');

        // Создаем команды
        for ($i = 0; $i < min(50, count($teamNames)); $i++) {
            $name = $teamNames[$i];
            $alias = Str::slug($name);

            // Случайная страна и город из этой страны
            $country = $countries->random();
            $city = $cities->where('country_id', $country->id)->random();

            // Если нет города в этой стране, берем любой город
            if (!$city) {
                $city = $cities->random();
            }

            $stadiumName = $stadiumNames[$i % count($stadiumNames)] ?? 'Стадион ' . $name;
            $dateCreated = fake()->numberBetween(1890, 2020);

            Team::create([
                'name' => $name,
                'alias' => $alias,
                'stadium' => $stadiumName,
                'stadium_info' => 'Стадион вместимостью ' . fake()->numberBetween(20000, 100000) . ' зрителей. Построен в ' . fake()->numberBetween(1900, 2020) . ' году.',
                'description' => fake()->text(1000),
                'logo' => '/images/teams/' . $alias . '.png',
                'title' => $name . ' - Официальный сайт футбольного клуба',
                'meta_description' => 'Официальный сайт футбольного клуба ' . $name . '. Новости, состав, календарь матчей, результаты.',
                'country_id' => $country->id,
                'city_id' => $city->id,
                'date_created' => $dateCreated,
                'stadium_small_preview' => '/images/stadiums/' . $alias . '_small.jpg',
                'stadium_big_preview' => '/images/stadiums/' . $alias . '_big.jpg',
                'status' => fake()->boolean(90), // 90% активных команд
            ]);
        }

        $this->command->info('Команды созданы успешно!');
    }
}
